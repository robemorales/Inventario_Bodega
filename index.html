<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario IT - Bodega</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        body { background-color: #f4f7f6; }
        .container { margin-top: 30px; }
        .card { box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div class="container">
    <div class="card p-4">
        <h2 class="text-primary">游닍 Gesti칩n de Inventario IT</h2>
        <p class="text-muted">Laptops, Rallybars, Accesorios y m치s.</p>
        
        <hr>

        <div class="row g-3">
            <div class="col-md-3">
                <input type="text" id="equipo" class="form-control" placeholder="Equipo (ej: Dell 5440)">
            </div>
            <div class="col-md-3">
                <input type="text" id="serie" class="form-control" placeholder="N춿 de Serie">
            </div>
            <div class="col-md-3">
                <select id="categoria" class="form-select">
                    <option value="Laptop">Laptop</option>
                    <option value="Rallybar">Rallybar</option>
                    <option value="Mochila">Mochila</option>
                    <option value="Docking">Docking</option>
                </select>
            </div>
            <div class="col-md-3">
                <button onclick="agregarItem()" class="btn btn-success w-100">A침adir al Listado</button>
            </div>
        </div>

        <hr>

        <div class="table-responsive">
            <table class="table table-hover mt-3">
                <thead class="table-dark">
                    <tr>
                        <th>Equipo</th>
                        <th>Serie</th>
                        <th>Categor칤a</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tablaCuerpo"></tbody>
            </table>
        </div>

        <div class="d-flex gap-2 mt-4">
            <button onclick="descargarExcel()" class="btn btn-outline-primary">游닌 Descargar Reporte Excel</button>
            <input type="file" id="importar" class="d-none" onchange="importarExcel(event)">
            <button onclick="document.getElementById('importar').click()" class="btn btn-outline-secondary">游닋 Cargar Base de Datos (Excel)</button>
        </div>
    </div>
</div>

<script>
    let inventario = JSON.parse(localStorage.getItem('it_inventario')) || [];

    function renderTabla() {
        const cuerpo = document.getElementById('tablaCuerpo');
        cuerpo.innerHTML = '';
        inventario.forEach((item, index) => {
            cuerpo.innerHTML += `
                <tr>
                    <td>${item.equipo}</td>
                    <td>${item.serie}</td>
                    <td><span class="badge bg-info text-dark">${item.categoria}</span></td>
                    <td><button onclick="eliminar(${index})" class="btn btn-danger btn-sm">Eliminar</button></td>
                </tr>`;
        });
        localStorage.setItem('it_inventario', JSON.stringify(inventario));
    }

    function agregarItem() {
        const equipo = document.getElementById('equipo').value;
        const serie = document.getElementById('serie').value;
        const categoria = document.getElementById('categoria').value;

        if(equipo && serie) {
            inventario.push({ equipo, serie, categoria });
            renderTabla();
            document.getElementById('equipo').value = '';
            document.getElementById('serie').value = '';
        } else {
            alert("Por favor completa los campos");
        }
    }

    function eliminar(index) {
        inventario.splice(index, 1);
        renderTabla();
    }

    function descargarExcel() {
        const ws = XLSX.utils.json_to_sheet(inventario);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Inventario");
        XLSX.writeFile(wb, "Inventario_IT_Bodega.xlsx");
    }

    function importarExcel(event) {
        const file = event.target.files[0];
        const reader = new FileReader();
        reader.onload = (e) => {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const firstSheet = workbook.SheetNames[0];
            const jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheet]);
            inventario = jsonData;
            renderTabla();
        };
        reader.readAsArrayBuffer(file);
    }

    renderTabla();
</script>
</body>
</html>